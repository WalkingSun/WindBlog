---
layout: blog
title: OSI七层模式
categories: [网络]
description: OSI模型
keywords: OSI模型
---

OSI模型是从底层往上层发展起来的

  这个模型推出的最开始，是因为美国人有两台机器之间进行通信的需求。


需求1：

科学家要解决的第一个问题是，两个硬件之间怎么通信。具体就是一台发些比特流，然后另一台能收到。


于是，科学家发明了物理层：

主要定义物理设备标准，如网线的接口类型、光纤接口类型、各种传输介质的传输速率等。它的主要作用是传输比特流（就是由1/0转化为电流强弱来进行传输，到达目的地后再转化为1/0，也就是我们常说的数模转换与模数转换）。这一层的数据叫做比特。


需求2：

现在通过电线能发数据流了，但是，我还希望通过无线电波，通过其它介质来传输。然后我还要保证传输过去的比特流是正确的，要有纠错功能。


于是，发明了数据链路层：

定义了如何让格式化数据以进行传输，以及如何控制对物理介质的访问。这一层通常还提供错误检测和纠正，以确保数据的可靠传输。


需求3：

现在我能发正确的发比特流数据到另一台计算机了，但是当我发大量数据时，可能需要好长时间，例如一个视频格式的，网络会中断好多次（事实上，即使有了物理层和数据链路层，网络还是经常中断，只是中断的时间是毫秒级别的）。

那么，我还必须保证传输大量文件时的准确性。于是，我要对发出去的数据进行封装。就像发快递一样，一个个地发。


于是，先发明了传输层（传输层在OSI模型中，是在网络层上面）

例如TCP，是用于发大量数据的，我发了1万个包出去，另一台电脑就是要告诉我是否接受到了1万个包，如果缺了3个包，就告诉我是第1001,234,8888个包丢了，那我再发一次。这样，就能保证对方把这个视频完整接收了。

例如UDP，是用于发送少量数据的。我发20个包出去，一般不丢包，所以，我不管你收到多少个。在多人互动游戏，也经常用UDP协议，因为一般都是简答的信息，而且有广播的需求。如果用TCP，效率就很低，因为它会不停地告诉主机我收到了20个包，或者我收到了18个包，再发我两个！如果同时有1万台计算机都这样做，那么用TCP反而会降低效率，还不如用UDP，主机发出去就算了，丢几个包你就卡一下，算了，下次再发包你再更新。

TCP协议是会绑定IP和端口的协议


需求4：

传输层只是解决了打包的问题。但是如果我有多台计算机，怎么找到我要发的那台？或者，A要给F发信息，中间要经过B，C,D,E但是中间还有好多节点如K,J,Z,Y.。我怎么选择最佳路径？这就是路由要做的事。


于是，发明了网络层。即路由器，交换机那些具有寻址功能的设备所实现的功能。这一层定义的是IP地址，通过IP地址寻址。所以产生了IP协议。


需求5：

现在我们已经保证给正确的计算机，发送正确的封装过后的信息了。但是用户级别的体验好不好?难道我每次都要调用TCP去打包，然后调用IP协议去找路由，自己去发？当然不行，所以我们要建立一个自动收发包，自动寻址的功能。


于是，发明了会话层。会话层的作用就是建立和管理应用程序之间的通信。


需求6：

现在我能保证应用程序自动收发包和寻址了。但是我要用Linux给windows发包，两个系统语法不一致，就像安装包一样，exe是不能在Linux下用的，shell在Windows下也是不能直接运行的。

于是需要表示层（presentation），帮我们解决不同系统之间的通信语法问题。


需求7：

应用层

与其它计算机进行通讯的一个应用，它是对应应用程序的通信服务的。

如FTP、SMTP、TELNET

socket：

这不是一个协议，而是一个通信模型。主要用来一个电脑的两个进程间通信，然后把它用到了两台电脑的进程间通信。所以，可以把它简单理解为进程间通信，不是什么高级的东西。主要做的事情就是：

A发包：发请求包给某个已经绑定的端口（connect函数）；收到B的允许；然后正式发送；发送完了，告诉B要断开链接；收到断开允许，马上断开，然后发送已经断开信息给B.

B收包：绑定端口和IP（bind函数）;然后在这个端口监听（listen函数）；（accept函数）接收到A的请求，发允许给A，并做好接收准备，主要就是清理缓存等待接收新数据；然后正式接收；接受到断开请求，允许断开；确认断开后，继续监听其它请求。

可见，socket其实就是I/O操作。socket并不仅限于网络通信。在网络通信中，它涵盖了网络层、传输层、会话层、表示层、应用层--其实这都不需要记，因为socket通信时候用到了IP和端口，仅这两个就表明了它用到了网络层和传输层；而且它无视多台电脑通信的系统差别，所以它涉及了表示层；一般socket都是基于一个应用程序的，所以会涉及到会话层和应用层。

![20210916114643](https://raw.githubusercontent.com/WalkingSun/WindBlog/gh-pages/images/ws2/20210916114643.png)

物理层：设备间通信有线介质接口规范，传输比特流的媒介；
数据链路层：还可以支持无线介质，规范传输数据格式规范，做些拦截、校验；
传输层：比如大文件传输需要持续很长时间，通过传输层可以一个包一个包进行传输，如TCP；
网络层：发送接收需要寻址，多个节点传输最终的目的地需要明确。即路由器，IP寻址；
会话层：频繁TCP打包、IP寻址，需要建立会话，自动打包及寻址；
表示层：解决不同系统间的通信语法问题；
应用层：通讯的应用，应用程序的通信服务，如：SMTP、FTP；

Reference：

https://baike.baidu.com/item/%E7%BD%91%E7%BB%9C%E4%B8%83%E5%B1%82%E5%8D%8F%E8%AE%AE/6056879

https://www.cnblogs.com/aspirant/p/10813139.html